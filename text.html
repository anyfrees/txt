<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uptime Kuma 状态监控</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEJQ3+0f7l7haqZKCr0hXhJ9+g8Nq5uF5B4c2Wf5Bx0nxp7Hp5thGyBFSKx50" crossorigin="anonymous">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 1000px;
            margin-top: 50px;
        }
        .status-card {
            transition: transform 0.3s ease;
        }
        .status-card:hover {
            transform: scale(1.05);
        }
        .status-up {
            background-color: #28a745;
            color: white;
        }
        .status-down {
            background-color: #dc3545;
            color: white;
        }
        .status-unknown {
            background-color: #ffc107;
            color: white;
        }
        .card-body {
            padding: 20px;
        }
        .btn-refresh {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="text-center mb-4">Uptime Kuma 状态监控</h1>
    <button id="refreshButton" class="btn btn-primary btn-refresh">手动刷新</button>
    <div id="statusContainer" class="row">
        <!-- 动态加载状态卡片 -->
    </div>
</div>

<script>
    const instances = [
        { name: "Region 1", url: "https://ping.0vk.com/api/v1/statuses", api_key: "uk1_pJv-KGRvz-4I9fY-sTHG2DsphU9Ska9goNOBNlED" },
        { name: "Region 2", url: "http://region2-ip:3001/api/v1/statuses", api_key: "your_api_key" }
    ];

    // 获取状态并更新页面
    async function fetchStatus() {
        const statusContainer = document.getElementById('statusContainer');
        statusContainer.innerHTML = ''; // 清空现有内容

        for (const instance of instances) {
            const response = await fetch(instance.url, {
                headers: {
                    "Authorization": `Bearer ${instance.api_key}`
                }
            });

            if (response.ok) {
                const statuses = await response.json();
                statuses.forEach(status => {
                    const statusClass = status.status === "up" ? "status-up" : (status.status === "down" ? "status-down" : "status-unknown");
                    const card = `
                        <div class="col-md-4">
                            <div class="card status-card ${statusClass}">
                                <div class="card-body">
                                    <h5 class="card-title">${status.name}</h5>
                                    <p class="card-text">状态: <strong>${status.status.toUpperCase()}</strong></p>
                                    <p class="card-text">延迟: ${status.latency} ms</p>
                                    <p class="card-text">最后检查: ${new Date(status.last_checked).toLocaleString()}</p>
                                    <p class="card-text">地域: ${instance.name}</p>
                                </div>
                            </div>
                        </div>
                    `;
                    statusContainer.insertAdjacentHTML('beforeend', card);
                });
            } else {
                console.error(`无法从 ${instance.name} 获取数据`);
            }
        }
    }

    // 手动刷新数据
    document.getElementById('refreshButton').addEventListener('click', fetchStatus);

    // 自动每5分钟刷新
    setInterval(fetchStatus, 5 * 60 * 1000); // 每5分钟自动刷新

    // 页面加载时先执行一次
    fetchStatus();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-GLhlTQ8iRAB2zQ3fT4pD1mW1YvnnaZuB5pXygImcYaKgZqRocV3w15YI7n3Pb9p8" crossorigin="anonymous"></script>
</body>
</html>
